/* get the privilege domains for specific user ID

   INPUT  : user ID
   OUTPUT : list of domain names
*/
CREATE PROC getPrivilegeDomains ( @userID userIdentifier )
AS
BEGIN
  DECLARE @lastError int

  BEGIN TRAN getPrivilegeDomains
    SELECT domain
      FROM privilegeDomains
      WHERE ( userID = @userID )
    
    SELECT @lastError = @@error
    IF @lastError != 0
    BEGIN
      ROLLBACK TRAN getPrivilegeDomains
      RETURN @lastError
    END
  COMMIT TRAN getPrivilegeDomains
END
GO
