/*
 * Get an access list entry for a notify list for a specific account
 *
 */
IF EXISTS (SELECT name FROM sysobjects WHERE name='getNotifyAccessListByAcct' AND type='P')
 DROP PROC getNotifyAccessListByAcct
GO
CREATE PROC getNotifyAccessListByAcct (
	@notifyID	userIdentifier,
	@accountID	userIdentifier
)
AS
BEGIN
  IF @notifyID = 0
  BEGIN
    SELECT userID, notifyAccessList.notifyID, notifyAccessList.locked, maxMsgs, msgInterval, msgCount, description, type
      FROM notifyAccessList, notifyLists
      WHERE accountID = @accountID
      AND notifyAccessList.notifyID = notifyLists.notifyID
      AND notifyLists.deleted = 0
      AND   accessPriv & 0x01 = 0x01
  END
  ELSE BEGIN
    SELECT userID, accountID, notifyAccessList.locked, maxMsgs, msgInterval, msgCount, type
      FROM notifyAccessList, notifyLists
      WHERE notifyAccessList.notifyID  = @notifyID
      AND   accountID = @accountID
      AND   notifyAccessList.notifyID = notifyLists.notifyID
      AND   notifyLists.deleted = 0
      AND   accessPriv & 0x01 = 0x01
  END
END
GO
